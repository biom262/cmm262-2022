---
title: "Statistics Module - Day 1"
output:
  html_document:
    df_print: paged
---

# CMM262: Statistics, Day 2 - Part 1 - Distributions 

### Exercise 3 - Introduction to distributions in R using the binomial distribution as an example

R has many built-in functions for working with distributions. These generally follow these conventions:

Probability Density Functions (PDFs and PMFs) start with 'd' for 'density'.

Cumulative Distribution Functions (CDFs) start with p for 'probability'.

Quantile Functions start with q. 

Functions to generate random values from a distribution start with 'r' for random.

Let's learn how to use these functions in the context of the binomial distribution. The binomial distribution describes the number of 'successes' (k) observed from n Bernoulli trials.


Let's plot the binomial PMF using parameters: n=10 and p=0.1.

```{r}
n = 10
k = seq(0, n, by=1)
p = 0.1
y = dbinom(k, n, p)

binom.pmf <- data.frame(k=k, mass=y)

ggplot(binom.pmf,  aes(k, mass)) + geom_point(color="blue", size=3) + theme_bw(base_size=22)
```
Now let's plot the binomial Probability Mass Function for n=15, and p=0.5.

```{r}
n = 15
p=0.5
k = seq(0, n, by=1)
y = dbinom(k, n, p)

binom.pmf <- data.frame(k=k, mass=y)

ggplot(binom.pmf,  aes(k, mass)) + geom_point(color="blue", size=3) + theme_bw(base_size=22)
```

Now let's randomly sample from the binomial distribution with the same parameters as above.

```{r}
num.samples <- 100
k <- rbinom(num.samples, 15, 0.5)

# Plot a histogram of the random sample
hist(k, breaks=10)
```



Revisiting the penguin dataset, how many male penguins are there in our sample?

```{r}
library(palmerpenguins)

# remove samples where sex is unknown
penguins <- penguins[!is.na(penguins$sex),]


n.male = sum(penguins$sex == "male")
n.female = sum(penguins$sex == "female")
n.penguin = n.male + n.female

cat("There are", n.male, "male and", n.female, "female penguins" )
```

Assuming proportion parameter for male/female is 50%, what is the probability of observing exactly this number of male penguins in our sample?

```{r}
dbinom(n.male, n.penguin, 0.5)
```


Let's plot the theoretical probability density function for the sample of n penguins, asssuming p=0.5

```{r}
n = n.penguin
p=0.5
k = seq(0, n, by=1)
y = dbinom(k, n, p)

binom.pmf <- data.frame(k=k, mass=y)

ggplot(binom.pmf,  aes(k, mass)) + geom_point(color="blue", size=3) + theme_bw(base_size=22)
```

Is it surprising that we observed this many male penguins? How might we test this? 

Next class we will discuss hypothesis testing.
